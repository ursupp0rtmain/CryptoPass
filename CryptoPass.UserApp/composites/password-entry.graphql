# CryptoPass ComposeDB Schema
# This schema defines the structure for encrypted vault items on Ceramic Network
# All sensitive data is encrypted client-side before being stored

type VaultEntry @createModel(accountRelation: LIST, description: "CryptoPass encrypted vault entry") {
  # Unique identifier for the entry
  entryId: String! @string(minLength: 1, maxLength: 100)

  # Type of vault item: 'login', 'note', 'address', 'card'
  itemType: String! @string(minLength: 1, maxLength: 20)

  # Service/website name (unencrypted for search functionality)
  serviceName: String! @string(minLength: 1, maxLength: 200)

  # AES-GCM encrypted JSON containing all sensitive fields
  # For login: { username, password, url, totp, notes }
  # For note: { content, notes }
  # For address: { firstName, lastName, addressLine1, addressLine2, city, state, postalCode, country, notes }
  # For card: { cardholderName, cardNumber, expirationMonth, expirationYear, cvv, notes }
  encryptedData: String! @string(minLength: 1, maxLength: 50000)

  # Initialization Vector for AES-GCM decryption
  iv: String! @string(minLength: 1, maxLength: 100)

  # Category for organization (optional)
  category: String @string(maxLength: 100)

  # Favorite flag
  favorite: Boolean

  # Timestamps
  createdAt: DateTime!
  updatedAt: DateTime!
}

# Index for efficient queries by service name
type VaultEntryIndex @createModel(accountRelation: LIST, description: "Index for vault entries") {
  entry: StreamID! @documentReference(model: "VaultEntry")
  serviceName: String! @string(minLength: 1, maxLength: 200)
  itemType: String! @string(minLength: 1, maxLength: 20)
  updatedAt: DateTime!
}
