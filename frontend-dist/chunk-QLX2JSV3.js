import{c as P}from"./chunk-4HYFG62F.js";import{c as h,d as w,f as S}from"./chunk-ZVNJROIG.js";import{Da as f,La as m,Ma as g,T as s,Ta as e,Ua as i,Va as c,Wa as _,Xa as u,Y as v,Z as M,Za as x,_a as p,cb as a,db as E,ea as d,qa as r,yb as b}from"./chunk-XQ36P3UB.js";import"./chunk-IDCDGEFH.js";import"./chunk-BXSD24PQ.js";import"./chunk-TF4TY5JN.js";import{k as C}from"./chunk-KYPE3LET.js";function k(n,o){n&1&&(e(0,"div",6),c(1,"i",10),e(2,"p"),a(3,"MetaMask is not installed."),i(),e(4,"p",9),a(5,"Please install MetaMask to use CryptoPass."),i(),e(6,"a",11),a(7," Install MetaMask "),i()())}function L(n,o){if(n&1&&(e(0,"div",13),c(1,"i",16),e(2,"p"),a(3),i()()),n&2){let t=p(2);r(3),E(t.errorMessage())}}function D(n,o){n&1&&(c(0,"i",17),e(1,"span"),a(2,"Connecting..."),i())}function z(n,o){n&1&&(c(0,"i",18),e(1,"span"),a(2,"Connect Wallet"),i())}function I(n,o){if(n&1){let t=_();e(0,"div",7),c(1,"i",12),m(2,L,4,1,"div",13),e(3,"button",14),x("click",function(){v(t);let O=p();return M(O.connectWallet())}),m(4,D,3,0)(5,z,3,0),i(),e(6,"div",15)(7,"p"),a(8,"Connect your wallet to access your encrypted password vault."),i(),e(9,"p",9),a(10,"Your passwords are encrypted locally and stored on IPFS."),i()()()}if(n&2){let t=p();r(2),g(t.errorMessage()?2:-1),r(),u("disabled",t.isConnecting()),r(),g(t.isConnecting()?4:5)}}var y=class n{web3Service=s(h);encryptionService=s(w);ceramicService=s(S);router=s(P);isConnecting=d(!1);errorMessage=d(null);connectionStep=d("");walletState=this.web3Service.walletState;ceramicState=this.ceramicService.sessionState;connectWallet(){return C(this,null,function*(){this.isConnecting.set(!0),this.errorMessage.set(null);try{if(!this.web3Service.isMetaMaskInstalled())throw new Error("MetaMask is not installed. Please install MetaMask to continue.");this.connectionStep.set("Connecting to MetaMask..."),yield this.web3Service.connect(),this.connectionStep.set("Creating decentralized identity...");let o=yield this.ceramicService.authenticate(window.ethereum);this.connectionStep.set("Deriving encryption key...");let t=yield this.encryptionService.deriveMasterKey(o);this.notifyExtension(t),this.connectionStep.set("Loading vault..."),yield this.router.navigate(["/vault"])}catch(o){console.error("Login error:",o),this.errorMessage.set(o.message||"Failed to connect wallet. Please try again.")}finally{this.isConnecting.set(!1),this.connectionStep.set("")}})}get hasMetaMask(){return this.web3Service.isMetaMaskInstalled()}get isAuthenticated(){return this.ceramicService.isAuthenticated()}notifyExtension(o){let t=this.walletState().address,l=this.ceramicService.getCurrentDID();window.postMessage({type:"CRYPTOPASS_LOGIN",walletAddress:t,masterKey:o,ceramicDid:l},"*")}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=f({type:n,selectors:[["app-login"]],decls:13,vars:1,consts:[[1,"login-container"],[1,"login-card","card","glass"],[1,"login-header"],[1,"display-font"],[1,"subtitle"],[1,"login-content"],[1,"warning-message"],[1,"connect-section"],[1,"login-footer"],[1,"small"],[1,"pi","pi-exclamation-triangle"],["href","https://metamask.io/download/","target","_blank","rel","noopener noreferrer",1,"btn"],[1,"pi","pi-wallet","wallet-icon"],[1,"error-message"],[1,"btn","btn-primary",3,"click","disabled"],[1,"info-text"],[1,"pi","pi-times-circle"],[1,"pi","pi-spin","pi-spinner"],[1,"pi","pi-sign-in"]],template:function(t,l){t&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),a(4,"CryptoPass"),i(),e(5,"p",4),a(6,"Decentralized Password Manager"),i()(),e(7,"div",5),m(8,k,8,0,"div",6)(9,I,11,3,"div",7),i(),e(10,"div",8)(11,"p",9),a(12,"Zero-Knowledge \u2022 Decentralized \u2022 Secure"),i()()()()),t&2&&(r(8),g(l.hasMetaMask?9:8))},dependencies:[b],styles:[".login-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:var(--sp-4)}.login-card[_ngcontent-%COMP%]{max-width:500px;width:100%;text-align:center}.login-header[_ngcontent-%COMP%]{margin-bottom:var(--sp-5)}.login-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:3rem;margin:0 0 var(--sp-2) 0;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.login-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--text-color);margin:0}.login-content[_ngcontent-%COMP%]{margin-bottom:var(--sp-5)}.connect-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--sp-4);align-items:center}.wallet-icon[_ngcontent-%COMP%]{font-size:4rem;color:var(--text-color);opacity:.7}.warning-message[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]{padding:var(--sp-3);border-radius:var(--r-sm);display:flex;flex-direction:column;gap:var(--sp-2);align-items:center}.warning-message[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem}.warning-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.warning-message[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{font-size:.9rem;opacity:.8}.warning-message[_ngcontent-%COMP%]{background:#ffc1071a;border:1px solid rgba(255,193,7,.3);color:#ffc107}.error-message[_ngcontent-%COMP%]{background:#f443361a;border:1px solid rgba(244,67,54,.3);color:#f44336}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border:none;color:#fff;padding:var(--sp-3) var(--sp-6);font-size:1.1rem;font-weight:600;display:flex;align-items:center;gap:var(--sp-2);justify-content:center;min-width:200px}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:var(--shadow-pop)}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:wait}.info-text[_ngcontent-%COMP%]{text-align:center}.info-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:var(--sp-2) 0;color:var(--text-color)}.info-text[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{font-size:.85rem;opacity:.7}.login-footer[_ngcontent-%COMP%]{padding-top:var(--sp-4);border-top:1px solid var(--border-color)}.login-footer[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-color);opacity:.6;margin:0}"]})};export{y as LoginComponent};
